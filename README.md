# WeiBoDataMining


[we are here](https://github.com/DataMiningBasedOnWeiBo/WeiBoDataMining.git)





## 关于聚类算法

by cww97

传统聚类算法多是采用Bag of words方法，容易引起短文本发生特征高维问题，因此需要挖掘词语间共现关系以及顺序关系，获取代表性较强的特征，进而降低特征维度。因此我们打算采用基于频繁项集的聚类算法。同时，在中文中，一个句子的意思除了考虑特征词，还应充分考虑句子的语义。而语义的研究主要是从语法意义角度去归纳，也就是词汇的各种组合。因此，我们小组采用基于频繁项集和语义的聚类算法

层次聚类分为三个步骤：

### 一、频繁项集创建初始情感簇，每个初始情感簇文本都含有频繁项集

该步骤在[apriori.py](emotion/apriori.py)中，根据原来微博文本的频繁项集创建初始的情感簇

1.扫描文本集 D，利用词频统计候选项集出现的次数，收集满足最小支持度 min_s 设定的项集，记为频繁项集； 

2.利用产生的频繁 k 项集构造强关联规则，利用频繁 k 项集构造候选(k+1)
项集，反复迭代直至候选(k+1)项集为空。

### 一、根据《知网》的中文语义相似度模型，根据最大语义隶属原则分离各个初始情感簇

该步骤在[overlap.py](emotion/overlap.py)中，使每个文档隶属于一个情感簇中

定义一个文档对于一个情感对隶属得分：
![socre](docs/pics/belongscore.png)

其中sim来自《知网》的中文语义相似度模型

对于一个与多个情感簇关联的文档，计算其对于每个情感簇的隶属得分，取其最大，删去其与剩余情感簇的关联

### 三.通过定义簇间语义相似度矩阵，完成微博情感簇的层次聚类，并优化得到最终情感簇

该步骤在[merge.py](emotion/merge.py)中，合并相似情感簇，得到最终聚类结果

定义两个情感簇的相似矩阵：
![sim_clu](docs/pics/sim_clu.png)

其中sim依然使来自知网的模型

计算两个情感簇的相似度，取其前k大个

![sim_clu_score](docs/pics/sim_clu_score.png)

然后利用简单的双重for循环计算任意两个情感簇的相似度，若最大的大于阈值，则合并之，否则return


最后，一个很关键的sim函数，也就是知网的语义相似模型，知网给的字典太尼玛大了，xb童鞋还在疯狂调试中，一调试就死机，我也很绝望啊
![boom](docs/pics/boom.jpg)


## 数据预处理

　　　1.collectWeiboDataByKeyword---------根据微博爬虫获取原始数据集<br>
　　　　　模拟登陆----->构造URL----->爬取网页----->解析网页<br>
　　　　　解析得到的数据：用户名，发布时间，微博内容<br>
　　　　　解析的数据存储至数据库中<br>
　　　　　需注意爬取微博的速度较慢，数据需提前爬取，速度过于频繁容易造成账号被封<br>
　　　2.NLPIR----------提取爬取的微博内容进行文本预处理<br>
　　　　　提取数据----->分词----->去除停用词------>匹配情感词典<br>
　　　3.数据库<br>
　　　　　微博文本通过MongoDB进行存储<br>
　　　　　**MongoDB配置**<br>
　　　　　　　WeiBoDB-------------->新建数据库<br>
　　　　　　　+---Collections<br>
　　　　　　　|　　　crawlerData------>用于保存原始数据和存储分词后的结果<br>
　　　　　**文档示例**<br>
 ```
　　　　　　　crawlerData
　　　　　　　{
　　　　　　　　　"_id" : ObjectId("59290b0bf67345bdd477402a"),
　　　　　　　　　"keyword" : "雄安新区",
　　　　　　　　　"username" : "百柳",
　　　　　　　　　"date" : "2017-04-02",
　　　　　　　　　"content" : "#雄安新区#燕赵大地上，又一个春天的故事正在谱写。河北雄安新区的设立，让京津冀协同发展拧成一股绳。三十多年的过
　　　　　　　　　　　　　　　河实践，摸到的石头不少，也探出了以点带面的不二法门。下好这招妙棋，年轻的新区使命不小。罗马并非一日建成，只有以
               　　　　　　　改革开道，实干辅底，方能收获所期盼的盎然春意。"
　　　　　　　　　"segresult" : "谱写 发展 使命 改革 实干 期盼 盎然 春意"
　　　　　　　}
```
